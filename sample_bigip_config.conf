#TMSH-VERSION: 15.1.0

# Sample F5 BIG-IP Configuration (Intentionally Vulnerable for Testing)

# WARNING: This configuration contains security issues for demonstration purposes

ltm profile client-ssl weak_ssl_profile {
app-service none
cert default.crt
key default.key
ciphers DEFAULT:RC4:DES
options { no-tlsv1.2 }
unclean-shutdown enabled
}

ltm profile client-ssl better_ssl_profile {
app-service none
cert secure.crt
key secure.key
ciphers ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256
options { no-tlsv1 no-tlsv1.1 }
}

ltm virtual test_https_vs {
destination 10.1.1.100:443
ip-protocol tcp
mask 255.255.255.255
profiles {
weak_ssl_profile {
context clientside
}
tcp { }
}
persist {
source_addr {
default yes
}
}
source 0.0.0.0/0
translate-address enabled
translate-port enabled
}

ltm virtual secure_https_vs {
destination 10.1.1.101:443
ip-protocol tcp
mask 255.255.255.255
pool secure_pool
profiles {
better_ssl_profile {
context clientside
}
tcp { }
http { }
}
source-address-translation {
type automap
}
persist {
cookie {
default yes
}
}
source 0.0.0.0/0
translate-address enabled
translate-port enabled
}

ltm pool secure_pool {
members {
10.2.1.10:80 {
address 10.2.1.10
}
10.2.1.11:80 {
address 10.2.1.11
}
}
monitor http
}

ltm pool unmonitored_pool {
members {
10.2.2.10:80 {
address 10.2.2.10
}
}
}

ltm rule redirect_irule {
when HTTP_REQUEST {
if { [HTTP::uri] contains “admin” } {
HTTP::redirect “https://[HTTP::host]/login”
}
HTTP::header insert X-Custom-Header [HTTP::uri]
}
}

ltm rule safe_irule {
when HTTP_REQUEST {
# Add security headers
HTTP::header insert Strict-Transport-Security “max-age=31536000”
HTTP::header insert X-Frame-Options “DENY”
HTTP::header insert X-Content-Type-Options “nosniff”
}
}

auth user admin {
description “Default admin account”
encrypted-password $6$abcdef
partition-access {
all-partitions {
role admin
}
}
shell bash
}

auth user testuser {
description “Test user with weak password”
encrypted-password $1$xyz123$
partition-access {
Common {
role operator
}
}
shell tmsh
}

sys httpd {
auth-pam-idle-timeout 1200
max-clients 10
ssl-port 8443
}

sys sshd {
banner enabled
banner-text “Authorized Access Only”
inactivity-timeout 600
}

sys snmp {
agent-addresses { 127.0.0.1:161 }
communities {
public {
community-name public
access ro
}
}
}

sys global-settings {
hostname bigip-test.example.com
mgmt-dhcp disabled
}

net self-allow {
defaults {
ospf:any
tcp:443
tcp:22
udp:161
}
}
